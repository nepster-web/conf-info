<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">

        <title>PSR - Чуть больше, чем стиль оформления кода</title>

        <link rel="shortcut icon" href="./images/favicon.png" type="image/x-icon">

        <meta name="description" content="PSR - Чуть больше, чем стиль оформления кода">
        <meta name="author" content="Анатолий Притульский">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="./css/reveal.css">
        <link rel="stylesheet" href="./css/base.css">
        <link rel="stylesheet" href="./css/sublime.css">
        <link rel="stylesheet" href="./css/style.css">

        <!-- If the query includes 'print-pdf', use the PDF print sheet -->
        <script>
            document.write( '<link rel="stylesheet" href="./css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
        </script>
    </head>

    <body>

        <div class="reveal">

            <div class="slides">

                <!-- ======================================================================================= -->
                <section class="title-slide">
                    <h1 style="margin-bottom: -5px;">PSR</h1>
                    <h3>Чуть больше, чем стиль оформления кода</h3>
                    <p style="margin-top: 32px">Анатолий Притульский</p>
                    <p>
                        <small>
                            <a href="http://travellizy.com">PHP Developer из Travellizy</a>
                        </small>
                    </p>
                    <p>
                        <a href="https://slides.nepster.pro/2019/PHP_Standards_Recommendations/presentation/index.html">
                            https://slides.nepster.pro
                        </a>
                        <br>
                        <img src="images/qr/url_to_conf_repository.png" alt="" style="max-width: 300px" />
                    </p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Про стандарты</h2>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>USB</h2>
                    <img src="images/Micro-USB-Cable.jpg" alt="" />
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Стандарты в PHP</h2>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h1>PSR</h1>
                    <h3>PHP Standards Recommendations</h3>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Оформление кода</h2>
                    <ul>
                        <li class="fragment">Кодировка файлов UTF-8 без BOM-байта.</li>
                        <li class="fragment">Классы объявляются в `StudlyCaps`</li>
                        <li class="fragment">Методы объявляются в lower `camelCase`</li>
                        <li class="fragment">Константы объявляются в ТАКОМ_ВИДЕ</li>
                        <li class="fragment">Закрывающий тег ?> ДОЛЖЕН отсутствовать</li>
                        <li class="fragment">...</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Code MUST use 4 spaces for indenting, not tabs.</h2>
                    <img src="images/spaces.gif" alt="" />
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h1>PSR</h1>
                    <h4>Чуть больше, чем стиль оформления кода</h4>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <img src="images/php-fig.jpeg" alt="" />
                    <h3>Framework Interoperability Group</h3>
                    <p><a href="https://www.php-fig.org/">https://php-fig.org</a></p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <img src="images/php-fig.jpeg" alt="" />
                    <h3>Группа была основана в 2009 году</h3>
                    <p>&nbsp;</p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <img src="images/php-fig.jpeg" alt="" />
                    <h3>Первый стандарт принят в 2010 году</h3>
                    <p>&nbsp;</p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Участники PHP-FIG</h2>
                    <p>Composer, Zend Framework, Yii framework, CakePHP, Slim, PHPixie, Joomla, Magento, Drupal, phpDocumentor и др.</p>
                    <a href="https://www.php-fig.org/personnel/">https://www.php-fig.org/personnel/</a>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Бывшие участники PHP-FIG</h2>
                    <p>Symfony, Laravel, Guzzle, Doctrine, Propel и др.</p>
                    <a href="https://www.php-fig.org/personnel/">https://www.php-fig.org/personnel/</a>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Почему покидают PHP-FIG?</h2>
                    <ul>
                        <li class="fragment">Дискуссии и споры</li>
                        <li class="fragment">Наследие и поддержка</li>
                        <li class="fragment">Личные предпочтения</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h3>PHP-FIG обсуждают новый стандарт</h3>
                    <img src="images/battle.jpg" alt="" />
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h1>Стандарты</h1>
                    <h3>Это - полезно!</h3>
                    <ul>
                        <li class="fragment">Понимание</li>
                        <li class="fragment">Порядок</li>
                        <li class="fragment">Переиспользование</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h1>Обзор PSR</h1>
                    <a href="https://www.php-fig.org/psr/">https://www.php-fig.org/psr/</a>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-1 / PSR-2 / <span style="color: #9f9f9f">PSR-12</span></h2>
                        <h3>Basic Coding Standard</h3>
                        <h3>Coding Style Guide</h3>
                        <h3 style="color: #9f9f9f">Extended Coding Style Guide</h3>
                    </section>
                    <section>
                        <h2>PhpStorm Reformat Code</h2>
                        <img src="images/format-code.gif" alt="" />
                    </section>
                    <section>
                        <h2>Code Sniffer</h2>
                        <a href="https://github.com/FriendsOfPHP/PHP-CS-Fixer">https://github.com/FriendsOfPHP/PHP-CS-Fixer</a>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-3</h2>
                        <h3>Logger Interface</h3>
                    </section>
                    <section>
                        <h2>Logger Interface</h2>
<pre><code class="">interface LoggerInterface
{
    public function emergency($message, array $context = array());

    public function alert($message, array $context = array());

    public function critical($message, array $context = array());

    public function error($message, array $context = array());

    public function warning($message, array $context = array());

    public function notice($message, array $context = array());

    public function info($message, array $context = array());

    public function debug($message, array $context = array());

    public function log($level, $message, array $context = array());
}</code></pre>
                    </section>
                    <section>
                        <h2>Monolog</h2>
                        <a href="https://github.com/Seldaek/monolog">https://github.com/Seldaek/monolog</a>
                    </section>
                    <section>
                        <h2>Нет поддержки PSR-3?</h2>
                    </section>
                    <section>
                        <h2>Используем адаптер</h2>
                        <a href="https://github.com/samdark/yii2-psr-log-target">https://github.com/samdark/yii2-psr-log-target</a>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2><s style="color: #9f9f9f">PSR-0</s> / PSR-4</h2>
                        <h3>Autoloading Standard</h3>
                    </section>
                    <section>
                        <h2>Оо ???</h2>
                        <pre><code>class MyLib {

    private $CI;

    public function __construct()
    {
        $this->CI = &get_instance();

        $this->CI->load->library('encrypt');
        $this->CI->load->library('session');
        $this->CI->load->library('url');

        $this->CI->load->helper('captcha');
        $this->CI->load->helper('cookie');
        $this->CI->load->helper('email');
    }

    ...

}</code></pre>
                    </section>
                    <section>
                        <h2><s style="color: #9f9f9f">PSR-0</s></h2>
                        <h3>Deprecated с 2014 года</h3>
                        <pre><code>function autoload($className)
{
    $className = ltrim($className, '\\');
    $fileName  = '';
    $namespace = '';
    if ($lastNsPos = strrpos($className, '\\')) {
        $namespace = substr($className, 0, $lastNsPos);
        $className = substr($className, $lastNsPos + 1);
        $fileName  = str_replace('\\', DIRECTORY_SEPARATOR, $namespace) . DIRECTORY_SEPARATOR;
    }
    $fileName .= str_replace('_', DIRECTORY_SEPARATOR, $className) . '.php';

    require $fileName;
}

spl_autoload_register('autoload');</code></pre>
                    </section>
                    <section>
                        <h2>Composer</h2>
                        <a href="https://getcomposer.org">https://getcomposer.org</a>
                    </section>
                    <section>
                        <h2>Composer Autoloading</h2>
                        <pre><code>"autoload": {
        "psr-4": {
            "Acme\\": "src/"
        }
    }
}</code></pre>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-6 / PSR-16</h2>
                        <h3>Caching Interface</h3>
                        <h3>Simple Caching Interface</h3>
                    </section>
                    <section>
                        <h2>PSR-16</h2>
                        <h3>Simple Caching Interface</h3>
                        <pre><code>interface CacheInterface
{
    public function get($key, $default = null);

    public function set($key, $value, $ttl = null);

    public function delete($key);

    public function clear();

    public function getMultiple($keys, $default = null);

    public function setMultiple($values, $ttl = null);

    public function deleteMultiple($keys);

    public function has($key);
}</code></pre>
                    </section>
                    <section>
                        <h2>PSR-6</h2>
                        <ul>
                            <li>CacheItemInterface</li>
                            <li>CacheItemPoolInterface</li>
                        </ul>
                        <br>
                        <a href="https://www.php-fig.org/psr/psr-6/">https://www.php-fig.org/psr/psr-6/</a>
                    </section>
                    <section>
                        <h2>Symfony Cache</h2>
                        <a href="https://github.com/symfony/cache">https://github.com/symfony/cache</a>
                    </section>
                    <section>
                        <h2>Zend Cache</h2>
                        <a href="https://github.com/zendframework/zend-cache">https://github.com/zendframework/zend-cache</a>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-7</h2>
                        <h3>HTTP Message Interface</h3>
                    </section>
                    <section>
                        <h2>Zend Diactoros</h2>
                        <h4>PSR-7 HTTP message implementations</h4>
                        <a href="https://github.com/zendframework/zend-diactoros">https://github.com/zendframework/zend-diactoros</a>
                    </section>
                    <section>
                        <h2>Guzzle и PSR-7</h2>
                        <a href="http://docs.guzzlephp.org/en/stable/psr7.html">http://docs.guzzlephp.org/en/stable/psr7.html</a>
                    </section>
                    <section>
                        <h2>HttpFoundation и PSR-7</h2>
                        <a href="https://github.com/symfony/psr-http-message-bridge">https://github.com/symfony/psr-http-message-bridge</a>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-11</h2>
                        <h3>Container Interface</h3>
                    </section>
                    <section>
                        <h2>Container Interface</h2>
                        <pre><code>interface ContainerInterface
{
    public function get($id);

    public function has($id);
}</code></pre>
                    </section>
                    <section>
                        <h2>Zend Expressive</h2>
                        <a href="https://docs.zendframework.com/zend-expressive/">https://docs.zendframework.com/zend-expressive/</a>
                    </section>
                    <section>
                        <h2>Пример работы PSR-11</h2>
                        <ul>
                            <li>HomePageHandler.php</li>
                            <li>HomePageHandlerFactory.php</li>
                        </ul>
                        <pre><code>class HomePageHandlerFactory
{
    public function __invoke(ContainerInterface $container): RequestHandlerInterface
    {
        $router   = $container->get(RouterInterface::class);
        $template = $container->has(TemplateRendererInterface::class)
            ? $container->get(TemplateRendererInterface::class)
            : null;
        return new HomePageHandler(get_class($container), $router, $template);
    }
}</code></pre>
                    </section>
                    <section>
                        <h2>Zend DI</h2>
                        <a href="https://github.com/zendframework/zend-di">https://github.com/zendframework/zend-di</a>
                    </section>
                    <section>
                        <h2>Symfony DI</h2>
                        <a href="https://github.com/symfony/dependency-injection">https://github.com/symfony/dependency-injection</a>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-13</h2>
                        <h3>Hypermedia Links</h3>
                    </section>
                    <section>
                        <h3>Общий способ представления hypermedia-ссылок</h3>
                    </section>
                    <section>
                        <h2>PSR-13 реализации</h2>
                        <a href="https://github.com/blongden/hal">https://github.com/blongden/hal</a>
                        <br>
                        <a href="https://github.com/blongden/hal">https://github.com/Crell/HtmlModel</a>
                    </section>
                    <section>
                        <h2>Hypermedia</h2>
                        <h4>то без чего ваше API не совсем REST</h4>
                        <a href="https://habr.com/ru/company/aligntechnology/blog/281206/">
                            https://habr.com/ru/company/aligntechnology/blog/281206/
                        </a>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-14</h2>
                        <h3>Event Dispatcher</h3>
                    </section>
                    <section>
                        ---
                    </section>
                    <section>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-15</h2>
                        <h3>HTTP Handlers</h3>
                    </section>
                    <section>
                        <h2>Symfony Controller</h2>
                        <pre><code>class DefaultController extends AbstractController
{
    /**
     * @Route("/", name="homepage")
     */
    public function index(): Response
    {
        $posts = $this->getDoctrine()
            ->getRepository(Post::class)
            ->findLatest();

        return $this->render('default/index.html.twig', [
            'posts' => $posts,
        ]);
    }
}</code></pre>
                    </section>
                    <section>
                        <h2>Symfony Controller</h2>
                        <pre><code>class DefaultController extends AbstractController
{
    public function list(): Response
    {
        // ...
    }

    public function update(): Response
    {
        // ...
    }

    public function create(): Response
    {
        // ...
    }

    public function delete(): Response
    {
        // ...
    }
}</code></pre>
                    </section>
                    <section>
                        <h2>Goodbye Controllers</h2>
                        <h3><a href="https://jenssegers.com/85/goodbye-controllers-hello-request-handlers">hello request handlers</a></h3>
                    </section>
                    <section>
                        <h2>Request Handler</h2>
                        <pre><code>class CreateUserHandler
{
    public function __construct(UserRepository $repository, Twig $twig)
    {
        // ...
    }

    public function __invoke(Request $request): Response
    {
        // ...
    }
}</code></pre>
                    </section>
                    <section>
                        <h2>PSR-15</h2>
                        <pre><code>interface RequestHandlerInterface
{
    public function handle(ServerRequestInterface $request): ResponseInterface;
}</code></pre>
                        <pre><code>interface MiddlewareInterface
{
    public function process(
        ServerRequestInterface $request,
        RequestHandlerInterface $handler
    ): ResponseInterface;
}</code></pre>
                    </section>
                    <section>
                        <h2>Zend Expressive Handler</h2>
                        <pre><code>use Psr\Http\Message\ResponseInterface;
use Zend\Diactoros\Response\JsonResponse;
use Psr\Http\Message\ServerRequestInterface;
use Psr\Http\Server\RequestHandlerInterface;

class PingHandler implements RequestHandlerInterface
{
    public function handle(ServerRequestInterface $request): ResponseInterface
    {
        return new JsonResponse(['ack' => time()]);
    }
}</code></pre>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-17</h2>
                        <h3>HTTP Factories</h3>
                    </section>
                    <section>
                        <h2>Создать Request</h2>
                        <pre><code>use Psr\Http\Message\UriInterface;
use Psr\Http\Message\RequestInterface;

interface RequestFactoryInterface
{
    public function createRequest(string $method, $uri): RequestInterface;
}</code></pre>
                    </section>
                    <section>
                        <h2>Создать ServerRequest</h2>
                        <pre><code>use Psr\Http\Message\UriInterface;
use Psr\Http\Message\ServerRequestInterface;

interface ServerRequestFactoryInterface
{
    public function createServerRequest(string $method, $uri, array $serverParams = []): ServerRequestInterface;
}</code></pre>
                    </section>
                    <section>
                        <h2>Создать Response</h2>
                        <pre><code>use Psr\Http\Message\ResponseInterface;

interface ResponseFactoryInterface
{
    public function createResponse(int $code = 200, string $reasonPhrase = ''): ResponseInterface;
}</code></pre>
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <section>
                        <h2>PSR-18</h2>
                        <h3>HTTP Client</h3>
                    </section>
                    <section>
                        ---
                    </section>
                    <section>
                        ---
                    </section>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>PSR - рекомендации</h2>
                    <h3>а не жесткие правила</h3>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h1>Вопросы</h1>
                    <p>
                        <a href="https://slides.nepster.pro/2019/PHP_Standards_Recommendations/presentation/index.html">
                            https://slides.nepster.pro
                        </a>
                        <br>
                        <img src="images/qr/url_to_conf_repository.png" alt="" style="max-width: 350px" />
                    </p>
                </section>
                <!-- ======================================================================================= -->

            </div>

        </div>

        <script src="./js/head.min.js"></script>
        <script src="./js/reveal.js"></script>

        <script>
            Reveal.initialize({
                width: 1180,
                height: 800,
                controls: true,
                progress: true,
                history: true,
                center: true,
                slideNumber: true,
                theme: Reveal.getQueryHash().theme,
                transition: Reveal.getQueryHash().transition || 'none',
                dependencies: [
                    { src: './js/dependencies/classList.js', condition: function() { return !document.body.classList; } },
                    { src: './js/dependencies/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                ]
            });
        </script>

    </body>
</html>

