<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">

        <title>Свежий взгляд на разработку API</title>

        <link rel="shortcut icon" href="./images/favicon.png" type="image/x-icon">

        <meta name="description" content="Свежий взгляд на разработку API">
        <meta name="author" content="Анатолий Притульский">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="./css/reveal.css">
        <link rel="stylesheet" href="./css/base.css">
        <link rel="stylesheet" href="./css/sublime.css">
        <link rel="stylesheet" href="./css/style.css">

        <!-- If the query includes 'print-pdf', use the PDF print sheet -->
        <script>
            document.write( '<link rel="stylesheet" href="./css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
        </script>
    </head>

    <body>


        <div class="reveal">

            <div class="slides">

                <!-- ======================================================================================= -->
                <section class="title-slide">
                    <h2>Свежий взгляд <br> на разработку API</h2>
                    <p>Притульский Анатолий</p>
                    <p>
                        <small>
                            <a href="http://travellizy.com">PHP Developer из Travellizy </a>
                        </small>
                    </p>
                    <p>
                        <a href="https://github.com/nepster-web/conf-info/2017/CodeID-GraphQL">https://github.com/nepster-web/conf-info/2017/CodeID-GraphQL</a>
                    </p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>О себе</h2>
                    <ul>
                        <li>PHP Developer</li>
                        <li>Стартапер</li>
                    </ul>
                    <div class="list">
                        <div class="list-item">
                            <a href="https://habrahabr.ru/users/nepster-web/" target="_blank">
                                <img src="./images/habrahabr.png" alt="" />
                                <span>nepster-web</span>
                            </a>
                        </div>
                        <div class="list-item">
                            <a href="https://github.com/nepster-web" target="_blank">
                                <img src="./images/github.png" alt="" />
                                <span>nepster-web</span>
                            </a>
                        </div>
                        <div class="list-item">
                            <a href="https://www.linkedin.com/in/nepster-web/" target="_blank">
                                <img src="./images/linkedin.png" alt="" />
                                <span>nepster-web</span>
                            </a>
                        </div>
                    </div>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <a href="http://travellizy.com" target="_blank">
                        <img src="./images/logo.png" alt="" />
                    </a>
                    <p style="font-size: 85%">
                        Мультиканальный, комплексный сервис в индустрии путешествий,
                        который работает с такими сегментами рынка как: отели, авиа и жд билеты, круизы, трансферы,
                        а также рестораны, концерты и другие виды досуга.
                    </p>
                    <ul>
                        <li class="fragment">Стартап</li>
                        <li class="fragment">PHP 7.1</li>
                        <li class="fragment">Не в продакшене</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>API</h2>
                    <p>(Application Programming Interface)</p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Говорим о API подразумеваем REST!?</h2>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h3>REST — архитектурная парадигма</h3>
                    <p>
                        Representational State Transfer <br> «передача состояния представления»
                    </p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Минусы REST API</h2>
                    <ul>
                        <li class="fragment" style="margin-bottom: 15px;">Не существует какого-то единого стандарта, который бы полностью описывал REST.</li>
                        <li class="fragment" style="margin-bottom: 15px;">Множество запросов для получения необходимых данных:
                            <ul style="margin-top: 0">
                                <li>GET /books/:id</li>
                                <li>GET /books/:id/comments</li>
                                <li>GET /books/:id/author</li>
                            </ul>
                        </li>
                        <li class="fragment" style="margin-bottom: 15px;">Почти RESTful</li>
                        <li class="fragment">...</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>RESTful - это сложно</h2>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Как вариант: JSON API</h2>
                    <p><a href="http://jsonapi.org">http://jsonapi.org</a></p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>JSON API</h2>
                    <ul>
                        <li>Стандартизирован</li>
                        <li>Не противоречит REST</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Еще некоторые виды API</h2>
                    <ul>
                        <li>SOAP</li>
                        <li>OData</li>
                        <li>GData</li>
                        <li>MQL</li>
                        <li>SparQL</li>
                        <li>???</li>
                        <li>...</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Популярные API</h2>
                    <ul>
                        <li>Почти RESTful</li>
                        <li>SOAP</li>
                        <li>???</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Что выбрать для разработки API?</h2>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>GraphQL</h2>
                    (A query language for your API)
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Что такое GraphQL?</h2>
                    <p>
                        В двух словах, GraphQL это синтаксис, который описывает как запрашивать данные,
                        и, в основном, используется клиентом для загрузки данных с сервера.
                    </p>
                    <p>Facebook используют GraphQL с 2012 года. А в 2015 году GraphQL стал доступен всем.</p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Плюсы GraphQL</h2>
                    <ul>
                        <li class="fragment" style="margin-bottom: 15px;">Facebook используют GraphQL с 2012 года.</li>
                        <li class="fragment" style="margin-bottom: 15px;">GraphQL решает реальные задачи.</li>
                        <li class="fragment" style="margin-bottom: 15px;">Просто и очевидно.</li>
                        <li class="fragment" style="margin-bottom: 15px;">Четкий и ясный API между backend и frontend.</li>
                        <li class="fragment" style="margin-bottom: 15px;">Уменьшает затраты на коммуникации.</li>
                        <li class="fragment" style="margin-bottom: 15px;">Все больше компаний переходит на GraphQL.</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Существует несколько реализаций GraphQL</h2>
                    <ul>
                        <li><a href="http://graphql.org/code/">От Facebook</a></li>
                        <li><a href="https://apollodata.com/">От Apollo</a></li>
                        <li><a href="https://github.com/chentsulin/awesome-graphql">Можно поискать еще...</a></li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Языковая поддержка GraphQL</h2>
                    <p><a href="http://graphql.org/code/">http://graphql.org/code/</a></p>
                    <ul>
                        <li>PHP</li>
                        <li>Go</li>
                        <li>Java</li>
                        <li>JavaScript</li>
                        <li>C# / .NET</li>
                        <li>Scala</li>
                        <li>Python</li>
                        <li>Ruby</li>
                        <li>...</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Кто использует GraphQL?</h2>
                    <p><a href="http://graphql.org/users/">http://graphql.org/users/</a></p>
                    <p><a href="https://github.com/APIs-guru/graphql-apis">https://github.com/APIs-guru/graphql-apis</a></p>
                    <p><img src="./images/whos-using-graphql.png" alt=""></p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>GitHub GraphQL API</h2>
                    <p><a href="https://developer.github.com/v4/explorer/">https://developer.github.com/v4/explorer/</a></p>
                    <p><img src="./images/github-example.png" alt=""></p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>GraphQL в действии</h2>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Пример запроса</h2>
                    <img src="./images/GraphQL-fields.png" alt="" style="width: 100%">
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Запрос с аргументами</h2>
                    <img src="./images/GraphQL-arguments.png" alt="" style="width: 100%">
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Параметры отдельно</h2>
                    <img src="./images/GraphQL-varriables.png" alt="" style="width: 100%">
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Пример мутации</h2>
                    <img src="./images/GraphQL-mutation.png" alt="" style="width: 100%">
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>GraphQL в PHP</h2>
                    <a href="https://github.com/webonyx/graphql-php" target="_blank">https://github.com/webonyx/graphql-php</a>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Frameworks</h2>
                    <ul>
                        <li><a href="https://github.com/rebing/graphql-laravel" target="_blank">Laravel5</a></li>
                        <li><a href="https://github.com/tsingsun/yii2-graphql" target="_blank">Yii2</a></li>
                        <li><a href="https://github.com/overblog/GraphQLBundle" target="_blank">Symfony2</a></li>
                        <li>...</li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Getting Started</h2>
                    <a href="http://webonyx.github.io/graphql-php/getting-started/" target="_blank">http://webonyx.github.io/graphql-php/getting-started/</a>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Первый запрос</h2>
<pre><code>query {
  echo(message: "Hello World")
}
</code></pre>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Object Type</h2>
<pre><code>use GraphQL\Type\Definition\ObjectType;
use GraphQL\Type\Definition\Type;

$queryType = new ObjectType([
    'name' => 'Query',
    'fields' => [
        'echo' => [
            'type' => Type::string(),
            'args' => [
                'message' => Type::nonNull(Type::string()),
            ],
            'resolve' => function ($root, $args) {
                return $root['prefix'] . $args['message'];
            }
        ],
    ],
]);
</code></pre>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2 style="margin-bottom: 0">Endpoint</h2>
                    <p style="margin-top: 0">graphql.php</p>
<pre><code>use GraphQL\GraphQL;
use GraphQL\Schema;

// Request data
// $query - GET or file_get_contents('php://input')
// $variables - GET or file_get_contents('php://input')
// ------------

$schema = new Schema(['query' => $queryType]);

try {
    $rootValue = ['prefix' => 'You said: '];
    $result = GraphQL::executeAndReturnResult($schema, $query, $rootValue, null, $variables);
    $output = $result->toArray();
} catch (\Exception $e) {
    $output = ['errors' => [['message' => $e->getMessage()]]];
}

header('Content-Type: application/json');
echo json_encode($output);
</code></pre>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Проверить</h2>
<pre><code>php -S localhost:8000 simple1.php
curl http://localhost:8080 -d '{"query": "query { echo(message: \"Hello World\") }" }'
</code></pre>
                    <p>или</p>
<pre><code>http://localhost/simple1.php?query=query{echo(message:"Hello World")}
</code></pre>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Результат</h2>
<pre><code>{
    "data": {
        "echo": "You said: Hello World"
    }
}</code></pre>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Примеры</h2>
                    <a href="https://github.com/nepster-web/conf-info/tree/master/2017/CodeID-GraphQL/demo" target="_blank">https://github.com/nepster-web/conf-info/tree/master/2017/CodeID-GraphQL/demo</a>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Подробная документация</h2>
                    <p><a href="http://webonyx.github.io/graphql-php/" target="_blank">http://webonyx.github.io/graphql-php/</a></p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Перевод на русский</h2>
                    <p><a href="http://graphql.org/learn/" target="_blank">http://graphql.org/learn/</a></p>
                    <p><img src="./images/curved-arrow.png" style="width: 120px;"></p>
                    <p><a href="https://github.com/nepster-web/GraphQL-ru" target="_blank">https://github.com/nepster-web/GraphQL-ru</a></p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h3>An in-browser IDE for <br> exploring GraphQL.</h3>
                    <p><a href="https://github.com/graphql/graphiql" target="_blank">https://github.com/graphql/graphiql</a></p>
                    <p><img src="./images/graphiql.png"></p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h3>Static page generator for documenting GraphQL Schema.</h3>
                    <p><a href="https://github.com/2fd/graphdoc" target="_blank">https://github.com/2fd/graphdoc</a></p>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Почитать:</h2>
                    <ul>
                        <li><a href="https://github.com/facebook/graphql" target="_blank">GraphQL specification.</a></li>
                        <li><a href="http://graphql.org/learn/" target="_blank">Learn GraphQL.</a></li>
                        <li><a href="https://habrahabr.ru/post/326986/" target="_blank">Что же такое этот GraphQL?</a></li>
                        <li><a href="https://habrahabr.ru/post/304182/" target="_blank">Почему за GraphQL будущее.</a></li>
                        <li><a href="https://habrahabr.ru/post/335050/" target="_blank">Анатомия запросов GraphQL.</a></li>
                        <li><a href="https://habrahabr.ru/post/335158/" target="_blank">Сравнение REST и GraphQL.</a></li>
                        <li><a href="https://habrahabr.ru/post/334182/" target="_blank">Покойся с миром, REST. Долгих лет жизни GraphQL.</a></li>
                    </ul>
                    <p><br></p>
                    <h4>Делаем GraphQL API на PHP и MySQL.</h4>
                    <ul>
                        <li>
                            <a href="https://habrahabr.ru/post/328122/" target="_blank">
                               1: Установка, схема и запросы
                            </a>
                        </li>
                        <li>
                            <a href="https://habrahabr.ru/post/329238/" target="_blank">
                                2: Мутации, переменные, валидация и безопасность
                            </a>
                        </li>
                        <li>
                            <a href="https://habrahabr.ru/post/329408/" target="_blank">
                                3: Решение проблемы N+1 запросов
                            </a>
                        </li>
                    </ul>
                </section>
                <!-- ======================================================================================= -->

                <!-- ======================================================================================= -->
                <section>
                    <h2>Вопросы</h2>
                    <p>
                        <a href="https://github.com/nepster-web/conf-info/2017/CodeID-GraphQL" target="_blank">
                            https://github.com/nepster-web/conf-info/2017/CodeID-GraphQL
                        </a>
                    </p>
                </section>
                <!-- ======================================================================================= -->
            </div>

        </div>

        <script src="./js/head.min.js"></script>
        <script src="./js/reveal.js"></script>

        <script>
            Reveal.initialize({
                width: 1180,
                height: 800,
                controls: true,
                progress: true,
                history: true,
                center: true,
                slideNumber: true,
                theme: Reveal.getQueryHash().theme,
                transition: Reveal.getQueryHash().transition || 'none',
                dependencies: [
                    { src: './js/dependencies/classList.js', condition: function() { return !document.body.classList; } },
                    { src: './js/dependencies/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                ]
            });
        </script>

    </body>
</html>

